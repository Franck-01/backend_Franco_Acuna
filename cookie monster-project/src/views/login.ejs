<div>
    <h2>Bienvenido</h2>
    <form class="formuser" enctype="multipart/form-data">
        <label for="loginName">Cual es tu nombre?:</label>
        <input name="nameuser" id="loginName" class="swal2-input">
        <label>Edad:</label>
        <input name="age" id="age" class="swal2-input">
        <label>nos faltaria un email:</label>
        <input name="mail" id="mail" class="swal2-input">
        <input type="submit" value="Iniciar Sesion" class="swal2-input">
    </form>
    <p id="user"></p>
</div>
<script src="https://unpkg.com/ejs@3.1.6/ejs.min.js"></script>
<script>
    let form = document.getElementById('formuser')
    let username = document.getElementById('loginName')

    const handleSubmit = (e) => {
        e.preventDefault()
        let formData = new FormData(e.target)

        fetch('/login', {
            method: 'POST',
            body: formData
        })

        form.reset()

        setTimeout(() => {
            location.reload()
        }, 500)
    }
    if (form) {
        form.addEventListener('submit', (e) => handleSubmit(e))
    }

    let user = username
    fetch("/login").then(us => us.json()).then(data => user = data.user)
    let userTemplate = document.getElementById("user")
    fetch("history/u_history.ejs").then(us => {
        return us.text()
    }).then(temp => {
        const html = ejs.render(temp, {
            user: user
        })
        userTemplate.innerHTML = html
    })
</script>
<style>
    .formuser {
        text-align: center;
        margin-left: 20%;
        margin-right: 20%;
    }
    
    label {
        color: white;
    }
    
    h2 {
        color: white;
    }
    
    .swal2-input {
        width: 90% !important;
        margin: .3em 0 1em !important;
        background: rgb(255, 255, 255);
        background: linear-gradient(0deg, rgba(255, 255, 255, 0) 0%, rgba(0, 0, 0, 0) 100%);
        color: white;
        padding: 1%;
        margin-left: 4%;
        margin-right: 4%;
    }
    
    .email {
        font-weight: bold;
        color: rgb(37, 37, 134);
    }
    
    .time {
        color: rgb(151, 40, 40);
        order: 2;
        margin-left: auto;
    }
</style>